{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/logistic-app/pages/auth/login.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport type { NextPage } from 'next';\r\nimport { Container, Box, Typography, TextField, Button, Grid, Link as MuiLink, Paper, Avatar } from '@mui/material';\r\nimport { useForm, SubmitHandler } from 'react-hook-form';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/router';\r\nimport LockOutlinedIcon from '@mui/icons-material/LockOutlined';\r\n\r\nconst API_URL = 'https://localhost:7106';\r\n\r\ntype LoginFormInputs = { email: string; pass: string; };\r\ninterface UserResponse { userId: number; email: string; name: string; role: string; }\r\n\r\nconst LoginPage: NextPage = () => {\r\n  const { register, handleSubmit, formState: { errors } } = useForm<LoginFormInputs>();\r\n  const router = useRouter();\r\n\r\n  const onSubmit: SubmitHandler<LoginFormInputs> = async (data) => {\r\n    try {\r\n      const response = await fetch(`${API_URL}/api/auth/login`, {\r\n        method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(data),\r\n      });\r\n      const result = await response.json();\r\n\r\n      if (!response.ok) { alert(`Login Failed: ${result.message || 'Invalid credentials'}`); throw new Error(result.message); }\r\n\r\n      if (result.token && result.user) {\r\n        localStorage.setItem('authToken', result.token);\r\n        const user: UserResponse = result.user;\r\n        localStorage.setItem('userRole', user.role);\r\n        \r\n        if (user.role === 'Admin') router.push('/admin');\r\n        else if (user.role === 'Customer') router.push('/customer');\r\n        else if (user.role === 'Driver') router.push('/driver');\r\n        else router.push('/');\r\n      }\r\n    } catch (error) { console.error('Failed to login:', error); }\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ \r\n      minHeight: '100vh', \r\n      display: 'flex', \r\n      alignItems: 'center', \r\n      background: 'linear-gradient(135deg, #1A1A1A 0%, #2C2C2C 100%)' // خلفية سوداء مودرن\r\n    }}>\r\n      <Container component=\"main\" maxWidth=\"xs\">\r\n        <Paper elevation={6} sx={{ p: 4, display: 'flex', flexDirection: 'column', alignItems: 'center', borderRadius: 3 }}>\r\n          <Avatar sx={{ m: 1, bgcolor: 'primary.main', color: 'black' }}>\r\n            <LockOutlinedIcon />\r\n          </Avatar>\r\n          <Typography component=\"h1\" variant=\"h5\" fontWeight=\"bold\">\r\n            Welcome Back\r\n          </Typography>\r\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 3 }}>\r\n            Sign in to Cargo<span style={{ color: '#FFC107', fontWeight: 'bold' }}>Xpress</span>\r\n          </Typography>\r\n\r\n          <Box component=\"form\" onSubmit={handleSubmit(onSubmit)} noValidate sx={{ mt: 1, width: '100%' }}>\r\n            <TextField\r\n              margin=\"normal\" required fullWidth id=\"email\" label=\"Email Address\" autoComplete=\"email\" autoFocus\r\n              {...register(\"email\", { required: \"Required\", pattern: { value: /^\\S+@\\S+$/i, message: \"Invalid email\" } })}\r\n              error={!!errors.email} helperText={errors.email?.message}\r\n            />\r\n            <TextField\r\n              margin=\"normal\" required fullWidth label=\"Password\" type=\"password\" id=\"pass\" autoComplete=\"current-password\"\r\n              {...register(\"pass\", { required: \"Required\", minLength: { value: 6, message: \"Min 6 chars\" } })}\r\n              error={!!errors.pass} helperText={errors.pass?.message}\r\n            />\r\n            <Button type=\"submit\" fullWidth variant=\"contained\" size=\"large\" sx={{ mt: 3, mb: 2, py: 1.5, fontWeight: 'bold', fontSize: '1rem' }}>\r\n              Sign In\r\n            </Button>\r\n            <Grid container justifyContent=\"flex-end\">\r\n              {/* @ts-ignore */}\r\n              <Grid item>\r\n                <Link href=\"/auth/register\" passHref>\r\n                  <MuiLink variant=\"body2\" sx={{ textDecoration: 'none', color: 'secondary.main' }}>\r\n                    {\"Don't have an account? Sign Up\"}\r\n                  </MuiLink>\r\n                </Link>\r\n              </Grid>\r\n            </Grid>\r\n          </Box>\r\n        </Paper>\r\n      </Container>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default LoginPage;"],"names":[],"mappings":"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","debugId":null}}]
}