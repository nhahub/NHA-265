{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///D:/Project/logistic-app/pages/auth/login.tsx"],"sourcesContent":["import * as React from 'react';\r\nimport type { NextPage } from 'next';\r\nimport { Container, Box, Typography, TextField, Button, Grid, Link as MuiLink } from '@mui/material';\r\nimport { useForm, SubmitHandler } from 'react-hook-form';\r\nimport Link from 'next/link';\r\nimport { useRouter } from 'next/router'; \r\n\r\nconst API_URL = 'https://localhost:7106'; \r\n\r\ntype LoginFormInputs = {\r\n  email: string;\r\n  pass: string;\r\n};\r\n\r\ninterface UserResponse {\r\n  userId: number;\r\n  email: string;\r\n  name: string;\r\n  role: string;\r\n}\r\n\r\nconst LoginPage: NextPage = () => {\r\n  const { register, handleSubmit, formState: { errors } } = useForm<LoginFormInputs>();\r\n  const router = useRouter(); \r\n\r\n  const onSubmit: SubmitHandler<LoginFormInputs> = async (data) => {\r\n    \r\n    try {\r\n      const response = await fetch(`${API_URL}/api/auth/login`, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(data), \r\n      });\r\n\r\n      const result = await response.json();\r\n\r\n      if (!response.ok) {\r\n        alert(`Login Failed: ${result.message || 'Invalid credentials'}`);\r\n        throw new Error(result.message || 'Something went wrong');\r\n      }\r\n\r\n      if (result.token && result.user) {\r\n        \r\n        localStorage.setItem('authToken', result.token);\r\n        \r\n        const user: UserResponse = result.user;\r\n        localStorage.setItem('userRole', user.role); \r\n\r\n        alert('Login Successful! Redirecting...');\r\n        \r\n        if (user.role === 'Admin') {\r\n          router.push('/admin');\r\n        } else if (user.role === 'Customer') {\r\n          router.push('/customer');\r\n        } else if (user.role === 'Driver') {\r\n          router.push('/driver');\r\n        } else {\r\n          router.push('/');\r\n        }\r\n\r\n      } else {\r\n        alert('Login successful, but no token or user data received.');\r\n      }\r\n\r\n    } catch (error) {\r\n      console.error('Failed to login:', error);\r\n      alert('Failed to connect to the server.');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Container component=\"main\" maxWidth=\"xs\">\r\n      <Box\r\n        sx={{\r\n          marginTop: 8,\r\n          display: 'flex',\r\n          flexDirection: 'column',\r\n          alignItems: 'center',\r\n        }}\r\n      >\r\n        <Typography component=\"h1\" variant=\"h5\">\r\n          Sign In\r\n        </Typography>\r\n        <Box component=\"form\" onSubmit={handleSubmit(onSubmit)} noValidate sx={{ mt: 1 }}>\r\n          <TextField\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            id=\"email\"\r\n            label=\"Email Address\"\r\n            autoComplete=\"email\"\r\n            autoFocus\r\n            {...register(\"email\", { \r\n              required: \"Email is required\",\r\n              pattern: {\r\n                value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,}$/i,\r\n                message: \"Invalid email address\"\r\n              }\r\n            })}\r\n            error={!!errors.email}\r\n            helperText={errors.email?.message}\r\n          />\r\n          <TextField\r\n            margin=\"normal\"\r\n            required\r\n            fullWidth\r\n            label=\"Password\"\r\n            type=\"password\"\r\n            id=\"pass\"\r\n            autoComplete=\"current-password\"\r\n            {...register(\"pass\", { \r\n              required: \"Password is required\",\r\n              minLength: {\r\n                value: 6,\r\n                message: \"Password must be at least 6 characters\"\r\n              }\r\n            })}\r\n            error={!!errors.pass}\r\n            helperText={errors.pass?.message}\r\n          />\r\n          <Button\r\n            type=\"submit\"\r\n            fullWidth\r\n            variant=\"contained\"\r\n            sx={{ mt: 3, mb: 2 }}\r\n          >\r\n            Sign In\r\n          </Button>\r\n          <Grid container>\r\n            {/* @ts-ignore */}\r\n            <Grid item>\r\n              <MuiLink component={Link} href=\"/auth/register\" variant=\"body2\">\r\n                {\"Don't have an account? Sign Up\"}\r\n              </MuiLink>\r\n            </Grid>\r\n          </Grid>\r\n        </Box>\r\n      </Box>\r\n    </Container>\r\n  );\r\n};\r\n\r\nexport default LoginPage;"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;AAEA,MAAM,UAAU;AAchB,MAAM,YAAsB;IAC1B,MAAM,EAAE,QAAQ,EAAE,YAAY,EAAE,WAAW,EAAE,MAAM,EAAE,EAAE,GAAG,IAAA,qJAAO;IACjE,MAAM,SAAS,IAAA,oIAAS;IAExB,MAAM,WAA2C,OAAO;QAEtD,IAAI;YACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,eAAe,CAAC,EAAE;gBACxD,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,MAAM,KAAK,SAAS,CAAC;YACvB;YAEA,MAAM,SAAS,MAAM,SAAS,IAAI;YAElC,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,CAAC,cAAc,EAAE,OAAO,OAAO,IAAI,uBAAuB;gBAChE,MAAM,IAAI,MAAM,OAAO,OAAO,IAAI;YACpC;YAEA,IAAI,OAAO,KAAK,IAAI,OAAO,IAAI,EAAE;gBAE/B,aAAa,OAAO,CAAC,aAAa,OAAO,KAAK;gBAE9C,MAAM,OAAqB,OAAO,IAAI;gBACtC,aAAa,OAAO,CAAC,YAAY,KAAK,IAAI;gBAE1C,MAAM;gBAEN,IAAI,KAAK,IAAI,KAAK,SAAS;oBACzB,OAAO,IAAI,CAAC;gBACd,OAAO,IAAI,KAAK,IAAI,KAAK,YAAY;oBACnC,OAAO,IAAI,CAAC;gBACd,OAAO,IAAI,KAAK,IAAI,KAAK,UAAU;oBACjC,OAAO,IAAI,CAAC;gBACd,OAAO;oBACL,OAAO,IAAI,CAAC;gBACd;YAEF,OAAO;gBACL,MAAM;YACR;QAEF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,oBAAoB;YAClC,MAAM;QACR;IACF;IAEA,qBACE,qKAAC,gNAAS;QAAC,WAAU;QAAO,UAAS;kBACnC,cAAA,qKAAC,wLAAG;YACF,IAAI;gBACF,WAAW;gBACX,SAAS;gBACT,eAAe;gBACf,YAAY;YACd;;8BAEA,qKAAC,oNAAU;oBAAC,WAAU;oBAAK,SAAQ;8BAAK;;;;;;8BAGxC,qKAAC,wLAAG;oBAAC,WAAU;oBAAO,UAAU,aAAa;oBAAW,UAAU;oBAAC,IAAI;wBAAE,IAAI;oBAAE;;sCAC7E,qKAAC,gNAAS;4BACR,QAAO;4BACP,QAAQ;4BACR,SAAS;4BACT,IAAG;4BACH,OAAM;4BACN,cAAa;4BACb,SAAS;4BACR,GAAG,SAAS,SAAS;gCACpB,UAAU;gCACV,SAAS;oCACP,OAAO;oCACP,SAAS;gCACX;4BACF,EAAE;4BACF,OAAO,CAAC,CAAC,OAAO,KAAK;4BACrB,YAAY,OAAO,KAAK,EAAE;;;;;;sCAE5B,qKAAC,gNAAS;4BACR,QAAO;4BACP,QAAQ;4BACR,SAAS;4BACT,OAAM;4BACN,MAAK;4BACL,IAAG;4BACH,cAAa;4BACZ,GAAG,SAAS,QAAQ;gCACnB,UAAU;gCACV,WAAW;oCACT,OAAO;oCACP,SAAS;gCACX;4BACF,EAAE;4BACF,OAAO,CAAC,CAAC,OAAO,IAAI;4BACpB,YAAY,OAAO,IAAI,EAAE;;;;;;sCAE3B,qKAAC,oMAAM;4BACL,MAAK;4BACL,SAAS;4BACT,SAAQ;4BACR,IAAI;gCAAE,IAAI;gCAAG,IAAI;4BAAE;sCACpB;;;;;;sCAGD,qKAAC,4LAAI;4BAAC,SAAS;sCAEb,cAAA,qKAAC,4LAAI;gCAAC,IAAI;0CACR,cAAA,qKAAC,4LAAO;oCAAC,WAAW,gIAAI;oCAAE,MAAK;oCAAiB,SAAQ;8CACrD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQjB;uCAEe","debugId":null}}]
}